<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CapyOS v17 - API Input Mode</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
      { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
    </script>
    <style>
        body { background: #000; color: white; font-family: sans-serif; overflow: hidden; height: 100vh; margin: 0; }
        .glass { background: rgba(20, 20, 20, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); }
        #api-gateway { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; }
        #os-interface { display: none; }
        .capy-glow { box-shadow: 0 0 50px #ff9500; animation: pulse 1.2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    </style>
</head>
<body>

    <div id="api-gateway">
        <div class="text-7xl mb-8 animate-bounce">ðŸ—¿</div>
        <h2 class="text-xl font-black text-orange-500 mb-6 tracking-widest">API ANAHTARINI DÃ–KÃœL KANKA</h2>
        <input id="api-key-input" type="text" placeholder="AIzaSy... anahtarÄ±nÄ± buraya Ã§ak" class="w-full bg-zinc-900 border-2 border-orange-600 p-4 rounded-3xl text-white mb-6 outline-none text-center font-mono text-xs">
        <button onclick="bootSystem()" class="w-full bg-orange-600 p-4 rounded-3xl font-black text-xl active:scale-90 transition-all shadow-lg shadow-orange-900/50">SÄ°STEMÄ° ATEÅžLE</button>
        <p class="mt-6 text-[10px] opacity-30 italic">Kanka bu anahtar sadece senin J7'de saklanÄ±r, GitHub gÃ¶remez.</p>
    </div>

    <div id="os-interface" class="p-6 h-full flex flex-col items-center">
        <div class="w-full flex justify-between text-[10px] font-bold opacity-50 mb-10">
            <span id="top-time">19:10</span>
            <span onclick="clearApi()" class="text-orange-500 border border-orange-500 px-2 py-1 rounded-lg text-[8px]">API SIFIRLA</span>
        </div>

        <div id="capy-trigger" class="mt-16 w-32 h-32 rounded-full glass flex items-center justify-center text-7xl cursor-pointer active:scale-95 transition-all">ðŸ—¿</div>
        <p id="ai-msg" class="mt-10 text-center text-orange-400 font-bold px-4 h-32 overflow-y-auto italic text-sm leading-relaxed">
            "Sinyal kulesi hazÄ±r kanka. ðŸ—¿'ya bas, Gemini ile uÃ§uÅŸa geÃ§elim!"
        </p>

        <div class="grid grid-cols-2 gap-10 mt-auto mb-10">
            <div onclick="window.open('https://m.youtube.com')" class="flex flex-col items-center">
                <div class="w-16 h-16 bg-red-600 rounded-3xl flex items-center justify-center text-3xl shadow-2xl">ðŸ“º</div>
                <span class="mt-2 text-[10px] font-bold tracking-tighter">YOUTUBE</span>
            </div>
            <div onclick="location.reload()" class="flex flex-col items-center">
                <div class="w-16 h-16 bg-zinc-800 rounded-3xl flex items-center justify-center text-3xl shadow-2xl">ðŸ”„</div>
                <span class="mt-2 text-[10px] font-bold tracking-tighter">RESET</span>
            </div>
        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // Sistem BaÅŸlatma KontrolÃ¼
        window.onload = () => {
            const key = localStorage.getItem('capy_secret_api');
            if (key) {
                document.getElementById('api-gateway').style.display = 'none';
                document.getElementById('os-interface').style.display = 'flex';
                runCapyMan(key);
            }
        };

        // AnahtarÄ± Kaydet
        window.bootSystem = () => {
            const input = document.getElementById('api-key-input').value.trim();
            if (input.length < 20) {
                alert("Kanka bu anahtar kÄ±sa kalmÄ±ÅŸ, resimdekini tam yaz!");
                return;
            }
            localStorage.setItem('capy_secret_api', input);
            location.reload();
        };

        // API SÄ±fÄ±rlama
        window.clearApi = () => {
            if(confirm("AnahtarÄ± siliyorum kanka, emin misin?")) {
                localStorage.removeItem('capy_secret_api');
                location.reload();
            }
        };

        // Gemini Motoru
        function runCapyMan(key) {
            const genAI = new GoogleGenerativeAI(key);

            document.getElementById('capy-trigger').onclick = async () => {
                const q = prompt("CapyMan-Gemini Sorusu:");
                if(!q) return;

                const msg = document.getElementById('ai-msg');
                const btn = document.getElementById('capy-trigger');
                
                msg.innerText = "Gemini'ye telsizden geÃ§iyorum kanka...";
                btn.classList.add('capy-glow');

                try {
                    const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                    const res = await model.generateContent(`Sen kanka tarzÄ±nda konuÅŸan bir Sigma Capybara'sÄ±n. Soru: ${q}`);
                    const response = await res.response;
                    msg.innerText = response.text();
                    
                    const s = new SpeechSynthesisUtterance(response.text());
                    s.lang = 'tr-TR'; s.pitch = 0.5; window.speechSynthesis.speak(s);
                } catch (e) {
                    msg.innerText = "Kanka API'de bir mevzu var. BÃ¼yÃ¼k ihtimal GitHub bunu sildiÄŸi iÃ§in iptal oldu. Yeni bir anahtar alÄ±p sÄ±fÄ±rla!";
                    console.error(e);
                } finally {
                    btn.classList.remove('capy-glow');
                }
            };
        }

        // Saat
        setInterval(() => {
            let d = new Date();
            document.getElementById('top-time').innerText = d.getHours().toString().padStart(2, '0') + ":" + d.getMinutes().toString().padStart(2, '0');
        }, 1000);
    </script>
</body>
</html>
