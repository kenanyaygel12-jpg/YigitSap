<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CapyOS v14 - Resimdeki API</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
      { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
    </script>
    <style>
        body { background: #000; color: white; font-family: sans-serif; overflow: hidden; height: 100vh; margin: 0; }
        .glass { background: rgba(20, 20, 20, 0.9); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); }
        .app-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.1, 0.9, 0.2, 1); z-index: 100; }
        .app-active { transform: translateY(0%); }
        #lock-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #050505; z-index: 500; transition: transform 0.5s ease; display: flex; flex-direction: column; align-items: center; justify-content: space-between; padding: 100px 0; touch-action: none; }
        .capy-glow { box-shadow: 0 0 60px #ff9500; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    </style>
</head>
<body>

    <div id="lock-screen">
        <div class="text-center">
            <h1 id="lock-clock" class="text-7xl font-thin tracking-tighter">00:00</h1>
            <p class="text-orange-500 font-bold mt-2">SIGMA UNLOCKED</p>
        </div>
        <div class="animate-bounce opacity-30 text-xs tracking-widest">YUKARI KAYDIR</div>
    </div>

    <div class="p-6 h-full flex flex-col items-center">
        <div class="w-full flex justify-between text-[10px] font-bold opacity-60">
            <span id="top-clock">00:00</span>
            <div class="flex items-center gap-1">
                <span id="bat-text">%--</span>
                <div class="w-5 h-2.5 border border-white rounded-sm overflow-hidden">
                    <div id="bat-level" class="h-full bg-green-500" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div id="capy-btn" class="mt-20 w-32 h-32 rounded-full glass flex items-center justify-center text-7xl cursor-pointer">ðŸ—¿</div>
        <div id="ai-status" class="mt-8 text-center text-orange-400 font-bold px-4 h-24 overflow-y-auto italic text-sm">
            "Resimdeki API baÄŸlandÄ± kanka. Sor bakalÄ±m, Gemini ne diyor?"
        </div>

        <div class="grid grid-cols-2 gap-10 mt-auto mb-10">
            <div onclick="window.open('https://m.youtube.com')" class="flex flex-col items-center">
                <div class="w-16 h-16 bg-red-600 rounded-3xl flex items-center justify-center text-3xl shadow-xl">ðŸŽ¬</div>
                <span class="mt-2 text-[10px] font-bold uppercase tracking-widest text-zinc-500">Video</span>
            </div>
            <div onclick="location.reload()" class="flex flex-col items-center">
                <div class="w-16 h-16 bg-zinc-800 rounded-3xl flex items-center justify-center text-3xl shadow-xl">ðŸ”„</div>
                <span class="mt-2 text-[10px] font-bold uppercase tracking-widest text-zinc-500">Restart</span>
            </div>
        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // RESÄ°MDEKÄ° TAM ANAHTAR:
        const API_KEY = "AIzaSyAxAd0fcZQ5q_N_yCUDFID7ei7kcMWR0YE";
        const genAI = new GoogleGenerativeAI(API_KEY);

        window.askCapy = async () => {
            const q = prompt("Gemini'ye dÃ¶kÃ¼l kanka:");
            if(!q) return;

            const st = document.getElementById('ai-status');
            const btn = document.getElementById('capy-btn');
            
            st.innerText = "DÃ¼ÅŸÃ¼nÃ¼yorum kanka...";
            btn.classList.add('capy-glow');

            try {
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                const result = await model.generateContent(`Sen kanka tarzÄ±nda konuÅŸan bir Sigma Capybara'sÄ±n. Soru: ${q}`);
                const response = await result.response;
                const text = response.text();

                st.innerText = text;

                // Seslendirme
                const s = new SpeechSynthesisUtterance(text);
                s.lang = 'tr-TR'; s.pitch = 0.5; window.speechSynthesis.speak(s);
            } catch (err) {
                console.error(err);
                st.innerText = "Kanka API'de bir mevzu var. Google Cloud'dan 'Generative Language API' aÃ§Ä±k mÄ± bi bak.";
            } finally {
                btn.classList.remove('capy-glow');
            }
        };

        document.getElementById('capy-btn').onclick = window.askCapy;
    </script>

    <script>
        // Swipe AÃ§Ä±lÄ±ÅŸ
        let sY = 0;
        const ls = document.getElementById('lock-screen');
        ls.addEventListener('touchstart', e => sY = e.touches[0].clientY);
        ls.addEventListener('touchmove', e => {
            let diff = sY - e.touches[0].clientY;
            if(diff > 0) ls.style.transform = `translateY(${-diff}px)`;
        });
        ls.addEventListener('touchend', e => {
            if(sY - e.changedTouches[0].clientY > 150) ls.style.transform = "translateY(-100%)";
            else ls.style.transform = "translateY(0%)";
        });

        // Saat & Pil
        setInterval(async () => {
            let d = new Date();
            let t = d.getHours().toString().padStart(2, '0') + ":" + d.getMinutes().toString().padStart(2, '0');
            document.getElementById('lock-clock').innerText = t;
            document.getElementById('top-clock').innerText = t;
            try { 
                const b = await navigator.getBattery();
                const lvl = Math.round(b.level * 100);
                document.getElementById('bat-text').innerText = `%${lvl}`;
                document.getElementById('bat-level').style.width = lvl + "%";
            } catch(e) {}
        }, 1000);
    </script>
</body>
</html>
